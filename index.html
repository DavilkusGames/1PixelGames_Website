<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <style type="text/css">
      
    </style>

    <title>VK_Transport Auth</title>
  </head>
  <body>
      <main>
          <h1 id="result_label">Authorization in progress</h1>
          <h2 id="vk_token_label">Please, wait...</h2>
      </main>

    <script>
        function auth_success(vk_token) {
            document.getElementById('result_label').innerHTML = 'Authorization succeeded';
            document.getElementById('vk_token_label').innerHTML = 'VK Token code: ' + vk_token;
        }

        function auth_fail(error) {
            document.getElementById('result_label').innerHTML = 'AUTHORIZATION FAILED';
            document.getElementById('vk_token_label').innerHTML = 'Error: ' + error;
        }

        var url = location.href;

        if (url.indexOf('?') != -1) {
            var params = url.split('?')[1].split('&');

            if (params.length > 0) {
                var param_found = false;
                for (i = 0; i <= params.length - 1; i++) {
                    var param = params[i].split('=')[0];
                    var param_value = params[i].split('=')[1];

                    if (param == 'code') {
                        auth_success(param_value);
                        param_found = true;
                        break;
                    }
                }

                if (!param_found) {
                    auth_fail('No parameter named \'code\' found');
                }
            }
            else {
                auth_fail('Parameters length is zero');
            }
        }
        else {
            auth_fail('No parameters given');
        }
    </script>
  </body>
</html>